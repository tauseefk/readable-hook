{"version":3,"file":"index.js","sources":["../src/utils/useThrottledCallback.tsx","../src/constants.ts","../src/useReadableHook.tsx","../src/utils/readableTextStream.ts","../src/useStreamingQuery.tsx","../src/useStreamingMutation.tsx"],"sourcesContent":["import { DependencyList, useRef, useEffect, useMemo } from 'react';\n\nexport interface ThrottledFunction<Fn extends (...args: unknown[]) => unknown> {\n  (this: ThisParameterType<Fn>, ...args: Parameters<Fn>): void;\n}\nexport const useThrottledCallback = <Fn extends (...args: unknown[]) => void>(\n  cb: Fn,\n  deps: DependencyList,\n  ms = 500,\n): ThrottledFunction<Fn> => {\n  const timeout = useRef<ReturnType<typeof setTimeout>>();\n  const cachedArgs = useRef<Parameters<Fn>>();\n\n  useEffect(() => {\n    const currentTimeout = timeout.current;\n    return () => {\n      if (currentTimeout) {\n        clearTimeout(currentTimeout);\n        timeout.current = undefined;\n      }\n    };\n  }, []);\n\n  return useMemo(() => {\n    const execCbAndSchedule = (args: Parameters<Fn>) => {\n      cachedArgs.current = undefined;\n      cb(args);\n\n      timeout.current = setTimeout(() => {\n        timeout.current = undefined;\n\n        if (cachedArgs.current) {\n          execCbAndSchedule(cachedArgs.current);\n\n          cachedArgs.current = undefined;\n        }\n      }, ms);\n    };\n\n    const throttledCb = (...args: Parameters<Fn>) => {\n      // execute immediately\n      if (!timeout.current) {\n        execCbAndSchedule(args);\n        return;\n      }\n\n      // cache arguments to be picked up by the next scheduled execution\n      cachedArgs.current = args;\n    };\n\n    return throttledCb;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [cb, ms, ...deps]);\n};\n","export type PrimitiveParam = string | boolean | number;\n\nexport interface UseReadableHookData {\n  value: string;\n  done: boolean;\n  isStreaming: boolean;\n}\n\nexport const DEFAULT_STREAM_DATA: UseReadableHookData = {\n  value: '',\n  done: false,\n  isStreaming: false,\n};\n","import { useCallback, useRef, useState } from 'react';\nimport { useThrottledCallback } from './utils/useThrottledCallback';\nimport {\n  DEFAULT_STREAM_DATA,\n  PrimitiveParam,\n  UseReadableHookData,\n} from './constants';\n\n/**\n * Synchronize React state with a ReadableStream.\n * @param {ReadableStream<String>} stream\n *  readable stream to synchronize with state\n * @param {number} delay\n *  time interval between each stream read call\n * @returns a tuple of data retrieved from the stream,\n *  and a mutation trigger function\n */\nexport const useReadableHook = (\n  streamProducer: (\n    params?: Record<string, PrimitiveParam>,\n  ) => Promise<ReadableStream<string>>,\n  delay = 500,\n): [\n  UseReadableHookData,\n  (options?: {\n    params?: Record<string, PrimitiveParam>;\n    onDone?: () => void;\n  }) => Promise<void>,\n] => {\n  const frequentlyUpdatedData = useRef(DEFAULT_STREAM_DATA);\n  const [{ value, done, isStreaming }, setThrottledData] = useState(\n    frequentlyUpdatedData.current,\n  );\n\n  const throttledUpdateState = useThrottledCallback(\n    () => {\n      setThrottledData({ ...frequentlyUpdatedData.current });\n    },\n    [],\n    delay,\n  );\n\n  const synchronize = useCallback(\n    async (options?: {\n      params?: Record<string, PrimitiveParam>;\n      onDone?: (value?: string) => void;\n    }) => {\n      frequentlyUpdatedData.current = DEFAULT_STREAM_DATA;\n\n      const response = await streamProducer(options?.params);\n      if (!response) throw new Error('No response from stream.');\n\n      const reader = response.getReader();\n\n      async function syncWithStream() {\n        const { value, done } = await reader.read();\n        if (!done) {\n          frequentlyUpdatedData.current = { value, done, isStreaming: true };\n          throttledUpdateState();\n\n          requestAnimationFrame(async () => {\n            await syncWithStream();\n          });\n          return;\n        }\n\n        frequentlyUpdatedData.current = {\n          ...frequentlyUpdatedData.current,\n          done: true,\n          isStreaming: false,\n        };\n        throttledUpdateState();\n        if (options?.onDone) options.onDone(frequentlyUpdatedData.current.value);\n      }\n\n      await syncWithStream();\n    },\n    [streamProducer, throttledUpdateState],\n  );\n\n  return [{ value, done, isStreaming }, synchronize];\n};\n","export const readableTextStream = async (\n  path: string,\n  options?: {\n    method: 'GET' | 'POST';\n    mode?: 'cors' | 'no-cors' | 'same-origin';\n    body?: string;\n    headers?: Record<string, string>;\n  },\n) => {\n  const response = await fetch(path, options);\n  if (!response.body) throw new Error('No response body found.');\n\n  return response.body.pipeThrough(new TextDecoderStream());\n};\n","import { useCallback, useRef, useState } from 'react';\nimport { useThrottledCallback } from './utils/useThrottledCallback';\nimport { DEFAULT_STREAM_DATA, PrimitiveParam } from './constants';\nimport { useReadableHook } from './useReadableHook';\nimport { readableTextStream } from './utils/readableTextStream';\n\n/**\n * Query a streaming endpoint\n * @param path streaming endpoint\n * @param delay time interval between each stream read call\n * @returns {[UseStreamingQueryData, () => void]}\n * returns a tuple of data retrieved from the stream, and a query function\n */\nexport const useStreamingQuery = (\n  path: string,\n  delay = 500,\n): [\n    { value: string; done: boolean; isStreaming: boolean },\n    (onDone?: (value?: string) => void) => Promise<void>,\n  ] => {\n  const frequentlyUpdatedData = useRef(DEFAULT_STREAM_DATA);\n  const [{ value, done, isStreaming }, setThrottledData] = useState(\n    frequentlyUpdatedData.current,\n  );\n\n  const throttledUpdateState = useThrottledCallback(\n    () => {\n      setThrottledData({ ...frequentlyUpdatedData.current });\n    },\n    [],\n    delay,\n  );\n\n  const streamQuery = useCallback(\n    async (onDone?: (value?: string) => void) => {\n      frequentlyUpdatedData.current = DEFAULT_STREAM_DATA;\n\n      const response = await readableTextStream(path, {\n        method: 'GET',\n      });\n      if (!response) throw new Error('No response from stream.');\n\n      const reader = response.getReader();\n\n      async function syncWithTextStream() {\n        const { value, done } = await reader.read();\n        if (!done) {\n          frequentlyUpdatedData.current = { value, done, isStreaming: true };\n          throttledUpdateState();\n\n          requestAnimationFrame(async () => {\n            await syncWithTextStream();\n          });\n          return;\n        }\n\n        frequentlyUpdatedData.current = {\n          ...frequentlyUpdatedData.current,\n          done: true,\n          isStreaming: false,\n        };\n        throttledUpdateState();\n        if (onDone) onDone(frequentlyUpdatedData.current.value);\n      }\n\n      await syncWithTextStream();\n    },\n    [path, throttledUpdateState],\n  );\n\n  return [{ value, done, isStreaming }, streamQuery];\n};\n\nexport const useStreamingQueryV2 = (\n  path: string,\n  delay = 500,\n): [\n    { value: string; done: boolean; isStreaming: boolean },\n    (options?: {\n      params?: Record<string, PrimitiveParam>;\n      onDone?: (value?: string) => void;\n    }) => Promise<void>,\n  ] =>\n  useReadableHook(\n    () =>\n      readableTextStream(path, {\n        method: 'GET',\n      }),\n    delay,\n  );\n","import { useRef, useState, useCallback } from 'react';\n\nimport { PrimitiveParam, DEFAULT_STREAM_DATA } from './constants';\nimport { useThrottledCallback } from './utils/useThrottledCallback';\nimport { readableTextStream } from './utils/readableTextStream';\nimport { useReadableHook } from './useReadableHook';\n\n/**\n * Trigger a mutation at a streaming endpoint\n * @param path streaming endpoint\n * @param staticParams params passed during hook initialization\n * @param delay time interval between each stream read call\n * @returns { [\n *  UseStreamingMutationData,\n *  (params?: Record<string, PrimitiveParam>) => void\n * ] }\n */\nexport const useStreamingMutation = (\n  path: string,\n  staticParams?: Record<string, PrimitiveParam>,\n  delay = 500,\n): [\n    { value: string; done: boolean; isStreaming: boolean },\n    (\n      params?: Record<string, PrimitiveParam>,\n      onDone?: (value?: string) => void,\n    ) => Promise<void>,\n  ] => {\n  const frequentlyUpdatedData = useRef(DEFAULT_STREAM_DATA);\n  const [{ value, done, isStreaming }, setThrottledData] = useState(\n    frequentlyUpdatedData.current,\n  );\n\n  const throttledUpdateState = useThrottledCallback(\n    () => {\n      setThrottledData({ ...frequentlyUpdatedData.current });\n    },\n    [],\n    delay,\n  );\n\n  const streamMutation = useCallback(\n    async (\n      params?: Record<string, PrimitiveParam>,\n      onDone?: (value?: string) => void,\n    ) => {\n      frequentlyUpdatedData.current = DEFAULT_STREAM_DATA;\n\n      const response = await readableTextStream(path, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ ...staticParams, ...params }),\n      });\n      if (!response) throw new Error('No response from stream.');\n\n      const reader = response.getReader();\n\n      async function syncWithTextStream() {\n        const { value, done } = await reader.read();\n        if (!done) {\n          frequentlyUpdatedData.current = { value, done, isStreaming: true };\n          throttledUpdateState();\n\n          requestAnimationFrame(async () => {\n            await syncWithTextStream();\n          });\n          return;\n        }\n\n        frequentlyUpdatedData.current = {\n          ...frequentlyUpdatedData.current,\n          done: true,\n          isStreaming: false,\n        };\n        throttledUpdateState();\n        if (onDone) onDone(frequentlyUpdatedData.current.value);\n      }\n\n      await syncWithTextStream();\n    },\n    [path, staticParams, throttledUpdateState],\n  );\n\n  return [{ value, done, isStreaming }, streamMutation];\n};\n\nexport const useStreamingMutationV2 = (\n  path: string,\n  staticParams?: Record<string, PrimitiveParam>,\n  delay = 500,\n): [\n    { value: string; done: boolean; isStreaming: boolean },\n    (options?: {\n      params?: Record<string, PrimitiveParam>;\n      onDone?: (value?: string) => void;\n    }) => Promise<void>,\n  ] =>\n  useReadableHook(\n    (params?: Record<string, PrimitiveParam>) =>\n      readableTextStream(path, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          ...staticParams,\n          ...params,\n        }),\n      }),\n    delay,\n  );\n"],"names":["useRef","useEffect","useMemo","useState","useCallback"],"mappings":"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"}